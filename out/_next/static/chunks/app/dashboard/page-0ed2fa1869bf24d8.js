(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{47790:()=>{},53638:(e,t,r)=>{Promise.resolve().then(r.bind(r,43686))},43686:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(95155),s=r(12115),n=r(32438),i=r(73312),o=r(22130),d=r(45221);function l(){var e;let{user:t,authenticated:r,login:l,ready:x}=(0,n.m)(),[m,h]=(0,s.useState)(!0),[f,p]=(0,s.useState)(null),[v,g]=(0,s.useState)(null),[w,y]=(0,s.useState)(null),b=(0,s.useCallback)(async()=>{var e;if(!(null==t?void 0:null===(e=t.wallet)||void 0===e?void 0:e.address)){y("No wallet address found.");return}h(!0),y(null);try{let e=await (0,d.uG)(t.wallet.address);if(p(e),"institution"===e){let e=await (0,d.Ix)(t.wallet.address);g(e)}else if("student"===e){let e=await (0,d.UV)(t.wallet.address);g(e)}else throw Error("Invalid role")}catch(e){console.error("Error loading dashboard data:",e),y("Failed to load dashboard data.")}finally{h(!1)}},[null==t?void 0:null===(e=t.wallet)||void 0===e?void 0:e.address]);return((0,s.useEffect)(()=>{r&&x&&b()},[r,x,b]),r&&x)?m?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"Loading dashboard..."})}):w?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)(o.Zp,{className:"p-4 bg-red-100 text-red-500",children:w})}):v?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:"institution"===f?(0,a.jsx)(c,{data:v}):"student"===f?(0,a.jsx)(u,{data:v}):(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"Invalid role."})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"No data available."})}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)(o.Zp,{className:"max-w-md mx-auto p-6 text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Connect Your Wallet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Please connect your wallet to view your dashboard"}),(0,a.jsx)(i.$,{onClick:()=>l(),children:"Connect Wallet"})]})})}function c(e){let{data:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Institution Dashboard"}),(0,a.jsxs)(o.Zp,{className:"p-4 mt-4",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Certificates:"})," ",t.totalCertificates]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Participants:"})," ",t.totalParticipants]})]})]})}function u(e){let{data:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Your Certificates"}),t.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:t.map((e,t)=>(0,a.jsxs)(o.Zp,{className:"p-4",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Institute:"})," ",e.institute]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Course:"})," ",e.course]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Transaction Hash:"})," ",e.txHash]}),(0,a.jsx)(i.$,{className:"mt-2",variant:"outline",children:"Download"})]},t))}):(0,a.jsx)("p",{className:"text-muted-foreground",children:"No certificates found."})]})}},73312:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(95155),s=r(12115),n=r(12317),i=r(31027),o=r(21567);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:l=!1,...c}=e,u=l?n.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(d({variant:s,size:i,className:r})),ref:t,...c})});l.displayName="Button"},22130:(e,t,r)=>{"use strict";r.d(t,{Zp:()=>i});var a=r(95155),s=r(12115),n=r(21567);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});i.displayName="Card",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",r),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})}).displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},21567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(43463),s=r(69795);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},45221:(e,t,r)=>{"use strict";r.d(t,{Ix:()=>h,UV:()=>f,WV:()=>u,uG:()=>m});var a=r(312),s=r(98982),n=r(25237),i=r(8720),o=r(85815);let d="0xC2679fBD37d54388Ce493F1DB75320D236e1815e",l=["event Attested(address indexed recipient, bytes32 indexed uid, bytes32 indexed schema)"],c=async()=>{try{if(void 0===window.ethereum)throw Error("MetaMask no est\xe1 instalado.");let e=new a.k(window.ethereum),t=await e.getSigner(),r=await t.getAddress(),n=new o.EAS(d);n.connect(t);let i=new s.NZ(d,l,e);return{eas:n,contract:i,account:r}}catch(e){throw console.error("Error al inicializar EAS:",e),e}},u=async e=>{let{institute:t,course:r,firstName:a,lastName:s,recipient:d}=e;if(!t||!r||!a||!s||!d)throw Error("Todos los campos son requeridos.");if(!(0,n.PW)(d))throw Error("La direcci\xf3n Ethereum proporcionada no es v\xe1lida.");let l=(0,i.b)(d),{eas:u}=await c();try{let e=new o.SchemaEncoder("string Institute,string Course,string FirstName,string LastName").encodeData([{name:"Institute",value:t,type:"string"},{name:"Course",value:r,type:"string"},{name:"FirstName",value:a,type:"string"},{name:"LastName",value:s,type:"string"}]),n=await u.attest({schema:"0x934fa076992c05c87e7a574767c4328cdde72b064891ce620c5f3126b046f4c4",data:{recipient:l,expirationTime:0,revocable:!0,refUID:"0x0000000000000000000000000000000000000000000000000000000000000000",data:e}});return await n.wait()}catch(e){throw console.error("Error al crear la atestaci\xf3n:",e),e}},x=async e=>{try{let{contract:t}=await c(),r=t.filters.Attested(e);return(await t.queryFilter(r)).map(e=>{let{recipient:t,uid:r,schema:a}=e.args;return{recipient:t,uid:r,schema:a,txHash:e.transactionHash}})}catch(e){throw console.error("Error al obtener las atestaciones:",e),e}},m=async e=>{try{if(e.endsWith("1"))return"institution";return"student"}catch(e){throw console.error("Error al determinar el rol del usuario:",e),e}},h=async e=>{try{let t=await x(e),r=t.length,a=new Set(t.map(e=>e.recipient)).size;return{totalCertificates:r,totalParticipants:a}}catch(e){throw console.error("Error al obtener m\xe9tricas de la instituci\xf3n:",e),e}},f=async e=>{try{return(await x(e)).map(e=>({institute:e.schema,course:"Curso Gen\xe9rico",firstName:"Nombre",lastName:"Apellido",recipient:e.recipient,txHash:e.txHash}))}catch(e){throw console.error("Error al obtener certificados del estudiante:",e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[952,818,141,234,441,517,358],()=>t(53638)),_N_E=e.O()}]);