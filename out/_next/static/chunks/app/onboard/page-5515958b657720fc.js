(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{47790:()=>{},70199:(e,t,r)=>{Promise.resolve().then(r.bind(r,57880))},57880:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var a=r(95155),s=r(76046),i=r(32438),n=r(73312),o=r(22130),c=r(12115),l=r(21567);let d=c.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});d.displayName="Input";var u=r(46195);let m=(0,r(31027).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),f=c.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(u.b,{ref:t,className:(0,l.cn)(m(),r),...s})});function h(e){let{onComplete:t}=e,[r,s]=(0,c.useState)({institute:"",course:"",firstName:"",lastName:"",recipient:""}),[o,l]=(0,c.useState)(!1),[u,m]=(0,c.useState)(null),[h,x]=(0,c.useState)(null),{user:p,ready:v}=(0,i.m)(),g=e=>{s({...r,[e.target.name]:e.target.value})},N=async e=>{e.preventDefault(),l(!0),m(null),x(null);try{if(!Object.values(r).every(e=>e))throw Error("Todos los campos son requeridos");let e={institute:r.institute,course:r.course,firstName:r.firstName,lastName:r.lastName,recipient:r.recipient};if(!Object.values(e).every(e=>e))throw Error("Todos los campos son requeridos");await t(e),x("Certificate created successfully")}catch(e){m(e instanceof Error?e.message:"Error creating certificate")}finally{l(!1)}};return p&&v?(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f,{htmlFor:"institute",children:"Institution Name"}),(0,a.jsx)(d,{id:"institute",name:"institute",value:r.institute,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f,{htmlFor:"course",children:"Course Name"}),(0,a.jsx)(d,{id:"course",name:"course",value:r.course,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f,{htmlFor:"firstName",children:"First Name"}),(0,a.jsx)(d,{id:"firstName",name:"firstName",value:r.firstName,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f,{htmlFor:"lastName",children:"Last Name"}),(0,a.jsx)(d,{id:"lastName",name:"lastName",value:r.lastName,onChange:g,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f,{htmlFor:"recipien",children:"Recipient Ethereum Address"}),(0,a.jsx)(d,{id:"recipient",name:"recipient",value:r.recipient,onChange:g,required:!0})]}),(0,a.jsx)(n.$,{type:"submit",disabled:o,children:o?"Issuing...":"Issue Certificate"}),u&&(0,a.jsx)("div",{className:"text-red-500",children:u}),h&&(0,a.jsx)("div",{className:"text-green-500",children:h})]}):(0,a.jsx)("div",{children:"Please connect your wallet to issue a certificate."})}f.displayName=u.b.displayName,r(7730);var x=r(92888),p=r(45221),v=r(25237);let g=[{id:"connect",title:"Connect Wallet",icon:x.JXP},{id:"create",title:"Create Certificate",icon:x.jH2},{id:"complete",title:"Complete",icon:x.YrT}];function N(){let[e,t]=(0,c.useState)("connect"),{login:r,authenticated:l}=(0,i.m)(),[d,u]=(0,c.useState)(!1),[m,f]=(0,c.useState)(null),x=(0,s.useRouter)();(0,c.useEffect)(()=>{l&&"connect"===e&&t("create")},[l,e]);let N=async e=>{u(!0),f(null);try{if(!e||!e.institute||!e.course||!e.firstName||!e.lastName||!e.recipient)throw Error("Todos los campos son requeridos");if(!(0,v.PW)(e.recipient))throw Error("La direcci\xf3n Ethereum proporcionada no es v\xe1lida");let r=await (0,p.WV)({institute:e.institute,course:e.course,firstName:e.firstName,lastName:e.lastName,recipient:e.recipient});if(r)console.log("Attestation created successfully:",r),t("complete");else throw Error("Error al crear la atestaci\xf3n")}catch(e){console.error("Error creating attestation:",e),f(e instanceof Error?e.message:"Error al crear el certificado")}finally{u(!1)}};return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-center mb-8",children:"Welcome to Torogoz 3"}),(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("div",{className:"flex justify-between mb-8",children:g.map(t=>(0,a.jsxs)("div",{className:"flex flex-col items-center ".concat(e===t.id?"text-primary":g.findIndex(t=>t.id===e)>g.findIndex(e=>e.id===t.id)?"text-primary/60":"text-muted-foreground"),children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center mb-2 ".concat(e===t.id?"bg-primary text-primary-foreground":"bg-muted"),children:(0,a.jsx)(t.icon,{className:"w-5 h-5"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:t.title})]},t.id))}),(0,a.jsxs)(o.Zp,{className:"p-6",children:["connect"===e&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Connect Your Wallet"}),(0,a.jsx)("p",{className:"mb-4",children:"Connect your wallet to get your Certificate"}),l?(0,a.jsx)(n.$,{onClick:()=>t("create"),children:"Continue"}):(0,a.jsx)(n.$,{onClick:()=>r(),children:"Connect Wallet"})]}),"create"===e&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Create Your First Certificate"}),(0,a.jsx)(h,{onComplete:N}),d&&(0,a.jsx)("p",{className:"mt-4 text-center text-muted-foreground",children:"Creating your certificate... Please wait."}),m&&(0,a.jsx)("p",{className:"mt-4 text-center text-red-600",children:m})]}),"complete"===e&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Onboarding Complete!"}),(0,a.jsx)("p",{className:"mb-4",children:"Congratulations! You have successfully created your first certificate."}),(0,a.jsx)(n.$,{onClick:()=>{try{x.push("/dashboard")}catch(e){console.error("Error navigating to dashboard:",e),f("Error al navegar al dashboard")}},className:"w-full",children:"Go to Dashboard"})]})]})]})]})}},73312:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(95155),s=r(12115),i=r(12317),n=r(31027),o=r(21567);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:l=!1,...d}=e,u=l?i.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(c({variant:s,size:n,className:r})),ref:t,...d})});l.displayName="Button"},22130:(e,t,r)=>{"use strict";r.d(t,{Zp:()=>n});var a=r(95155),s=r(12115),i=r(21567);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});n.displayName="Card",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",r),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...s})}).displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},21567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var a=r(43463),s=r(69795);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},45221:(e,t,r)=>{"use strict";r.d(t,{Ix:()=>h,UV:()=>x,WV:()=>u,uG:()=>f});var a=r(312),s=r(98982),i=r(25237),n=r(8720),o=r(85815);let c="0xC2679fBD37d54388Ce493F1DB75320D236e1815e",l=["event Attested(address indexed recipient, bytes32 indexed uid, bytes32 indexed schema)"],d=async()=>{try{if(void 0===window.ethereum)throw Error("MetaMask no est\xe1 instalado.");let e=new a.k(window.ethereum),t=await e.getSigner(),r=await t.getAddress(),i=new o.EAS(c);i.connect(t);let n=new s.NZ(c,l,e);return{eas:i,contract:n,account:r}}catch(e){throw console.error("Error al inicializar EAS:",e),e}},u=async e=>{let{institute:t,course:r,firstName:a,lastName:s,recipient:c}=e;if(!t||!r||!a||!s||!c)throw Error("Todos los campos son requeridos.");if(!(0,i.PW)(c))throw Error("La direcci\xf3n Ethereum proporcionada no es v\xe1lida.");let l=(0,n.b)(c),{eas:u}=await d();try{let e=new o.SchemaEncoder("string Institute,string Course,string FirstName,string LastName").encodeData([{name:"Institute",value:t,type:"string"},{name:"Course",value:r,type:"string"},{name:"FirstName",value:a,type:"string"},{name:"LastName",value:s,type:"string"}]),i=await u.attest({schema:"0x934fa076992c05c87e7a574767c4328cdde72b064891ce620c5f3126b046f4c4",data:{recipient:l,expirationTime:0,revocable:!0,refUID:"0x0000000000000000000000000000000000000000000000000000000000000000",data:e}});return await i.wait()}catch(e){throw console.error("Error al crear la atestaci\xf3n:",e),e}},m=async e=>{try{let{contract:t}=await d(),r=t.filters.Attested(e);return(await t.queryFilter(r)).map(e=>{let{recipient:t,uid:r,schema:a}=e.args;return{recipient:t,uid:r,schema:a,txHash:e.transactionHash}})}catch(e){throw console.error("Error al obtener las atestaciones:",e),e}},f=async e=>{try{if(e.endsWith("1"))return"institution";return"student"}catch(e){throw console.error("Error al determinar el rol del usuario:",e),e}},h=async e=>{try{let t=await m(e),r=t.length,a=new Set(t.map(e=>e.recipient)).size;return{totalCertificates:r,totalParticipants:a}}catch(e){throw console.error("Error al obtener m\xe9tricas de la instituci\xf3n:",e),e}},x=async e=>{try{return(await m(e)).map(e=>({institute:e.schema,course:"Curso Gen\xe9rico",firstName:"Nombre",lastName:"Apellido",recipient:e.recipient,txHash:e.txHash}))}catch(e){throw console.error("Error al obtener certificados del estudiante:",e),e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[844,952,818,141,234,465,441,517,358],()=>t(70199)),_N_E=e.O()}]);